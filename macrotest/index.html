<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macro Test</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Caveat+Brush&display=swap">
    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #FFFFFF; /* White background */
            overflow: hidden;
        }
        .container {
            text-align: center;
            position: relative;
            width: 100%;
            height: 100%;
        }
        .initial-screen, .game-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
        }
        .initial-screen {
            display: flex;
        }
        .game-screen {
            display: none;
        }
        button {
            padding: 15px 30px;
            font-size: 24px;
            font-family: 'Noto Sans', sans-serif;
            cursor: pointer;
            background-color: #0030F2;
            color: white;
            border: none;
            border-radius: 5px;
            margin: 20px;
            transition: background-color 0.3s; /* Smooth transition */
        }
        button:hover {
            background-color: #73B3E3; /* Darker color on hover */
        }
        #numberDisplay {
            font-size: 96px;
            font-family: 'Noto Serif', serif;
            font-weight: 500;
            margin: 20px;
            color: #FFFFFF; /* White text color for number */
            background-color: #E7722F; /* Orange background */
            padding: 20px 40px;
            border-radius: 10px;
            display: inline-block;
            user-select: none; /* Prevent text selection */
        }
        input {
            padding: 15px;
            font-size: 24px;
            font-family: 'Noto Sans', sans-serif;
            width: 150px;
            text-align: center;
            border: 2px solid #0030F2;
            border-radius: 5px;
            background-color: #FFFFFF; /* White background for input */
            color: #000000; /* Black text color for input */
        }
        #confirmButton {
            padding: 15px 20px;
            font-size: 24px;
            font-family: 'Noto Sans', sans-serif;
            cursor: pointer;
            background-color: #0030F2;
            color: white;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
            transition: background-color 0.3s; /* Smooth transition */
        }
        #confirmButton:hover {
            background-color: #73B3E3; /* Darker color on hover */
        }
        #result {
            font-size: 24px;
            margin-top: 20px;
            color: #000000; /* Black text color for result */
            user-select: none; /* Prevent text selection */
        }
        .hidden {
            display: none;
        }
        h1 {
            color: #FFA600; /* Dark yellow color */
        }
        .toggle-container {
            margin: 20px;
        }
        .toggle-container label {
            font-size: 20px;
            color: #000000; /* Black text color for label */
        }
        .toggle-switch {
            display: inline-block;
            position: relative;
            width: 60px;
            height: 34px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            border-radius: 50%;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: #0030F2;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .footer {
            font-size: 12px;
            color: #ccc;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="initial-screen">
            <h1>MACRO TEST</h1>
            <button id="tryButton">TRY</button>
            <div class="toggle-container" id="toggleContainer">
                <label for="toggleSwitch">Duplicate Numbers:</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggleSwitch" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        <div class="game-screen" id="game">
            <p id="numberDisplay"></p>
            <div id="inputContainer">
                <input type="text" id="guessInput" placeholder="Enter number" maxlength="4">
                <button id="confirmButton">CONFIRM</button>
            </div>
            <p id="result"></p>
        </div>
        <div class="footer">By SWK</div>
    </div>
    
    <script>
        let randomNumber = null;
        let startTime = null;
        let allowDuplicates = true;
        let timerId = null;
    
        function generateRandomNumber() {
            let numbers = [];
            let usedNumbers = new Set();
            while (numbers.length < 4) {
                let number = Math.floor(Math.random() * 10);
                if (allowDuplicates || !usedNumbers.has(number)) {
                    numbers.push(number);
                    usedNumbers.add(number);
                }
            }
            return numbers.join('');
        }
    
        function startGame() {
            // Check toggle switch state
            allowDuplicates = document.getElementById('toggleSwitch').checked;
    
            // Generate a random number based on the toggle state
            randomNumber = generateRandomNumber();
            startTime = new Date();
            document.getElementById('numberDisplay').textContent = randomNumber;
    
            // Switch to game screen
            document.querySelector('.initial-screen').style.display = 'none';
            document.getElementById('game').style.display = 'flex';
    
            // Focus on the input field and clear previous input
            const guessInput = document.getElementById('guessInput');
            guessInput.value = '';
            setTimeout(() => guessInput.focus(), 100);  // Slight delay to ensure focus
            document.getElementById('result').textContent = '';
            document.getElementById('inputContainer').classList.remove('hidden');
    
            // Set a timer to automatically return to TRY button if no action is taken
            if (timerId) clearTimeout(timerId);
            timerId = setTimeout(() => {
                resetToTryScreen();
            }, 60000); // 1 minute timeout
        }
    
        function checkGuess() {
            const userInput = document.getElementById('guessInput').value;
            const elapsedTime = (new Date() - startTime) / 1000;
    
            if (userInput === randomNumber) {
                document.getElementById('result').textContent = `CORRECT! - ${elapsedTime.toFixed(2)} sec`;
            } else {
                document.getElementById('result').textContent = 'FAIL!';
            }
    
            // Hide input and confirm button, show try button and toggle switch
            document.getElementById('inputContainer').classList.add('hidden');
            document.querySelector('.initial-screen').style.display = 'flex';
    
            // Keep the number and result displayed
            document.getElementById('numberDisplay').style.display = 'block';
            document.getElementById('result').style.display = 'block';
    
            // Clear timer since user has interacted
            if (timerId) clearTimeout(timerId);
        }
    
        function resetToTryScreen() {
            document.getElementById('inputContainer').classList.add('hidden');
            document.querySelector('.initial-screen').style.display = 'flex';
            document.getElementById('game').style.display = 'flex';  // Keep the number and result visible
        }
    
        document.getElementById('tryButton').addEventListener('click', startGame);
        document.getElementById('confirmButton').addEventListener('click', checkGuess);
    
        // Allow Enter key to confirm guess without clicking the button
        document.getElementById('guessInput').addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                checkGuess();
            }
        });
    </script>
</body>
</html>
